import{t as m,a as b}from"../chunks/CghSzh9C.js";import{p as Q,s as R,f as T,g as s,j as f,i as a,r as c,l as U,k,t as V}from"../chunks/BHUsKUmi.js";import{d as W,r as X,s as z}from"../chunks/CqqEqyuc.js";import{p as S,i as B}from"../chunks/ZOBCVC-6.js";import{e as Y,i as Z,b as $}from"../chunks/Bvb1pl9Y.js";import{k as C,p as F,l as G,e as H,i as tt,m as at,o as et,q as st}from"../chunks/CmaycYwG.js";function ot(g,o){s(o,!1)}async function it(g,o,e,n,y){const i=a(o);if(a(e)){const r=a(e),{success:v,message:q}=await at(r._id,i);v&&(r.content=i,r.updated=Date.now(),s(n,!1))}else{const{success:r,message:v,id:q}=await et(i);if(s(o,""),r){const x={_id:q,user_id:H.id,content:i,created:Date.now(),updated:Date.now()};a(y).push(x),s(n,!1)}}}async function rt(g,o,e,n){const y=a(o),{success:i,message:r}=await st(y._id);i&&(a(e).splice(a(e).findIndex(v=>v._id===y._id),1),s(n,!1))}var dt=(g,o)=>o(),_t=m("<button>Add post</button>"),nt=(g,o,e)=>o(a(e)),vt=m('<button class="edit svelte-1q34uyd">Edit</button>'),lt=m('<div class="post svelte-1q34uyd"><!> <div class="body svelte-1q34uyd"> </div> <div class="date svelte-1q34uyd"> </div></div>'),ct=m('<div class="actions_bar svelte-1q34uyd"><!></div> <div class="posts_area svelte-1q34uyd"></div>',1),ut=m("<button>Remove</button>"),ft=m('<div class="actions_bar svelte-1q34uyd"><button>Back</button></div> <div class="editor_area svelte-1q34uyd"><textarea class="editor_textarea svelte-1q34uyd"></textarea> <div class="editor_buttons svelte-1q34uyd"><button>Submit</button> <!></div></div>',1),pt=m('<div class="page svelte-1q34uyd"><!></div>');function kt(g,o){Q(o,!0);let e=R(S([])),n=R(!1);async function y(){let t=new URLSearchParams(location.search).get("id");if(t){s(n,!1);const d=await C(t);d&&s(e,S(await F(d)))}if(!t&&G()){s(n,!0);const d=H.id,_=await C(d);_&&s(e,S(await F(_)))}!t&&!G()&&(console.log("tried to view 'my posts' when not logged in ... navigating ..."),tt("/login"))}y();let i=R(!1),r=R(null),v=R("");function q(t=null){s(i,!0),s(r,S(t)),s(v,S(t?t.content:"")),console.log("show_editor",t)}var x=pt(),J=f(x);{var K=t=>{var d=ct(),_=U(d),E=f(_);{var j=u=>{var l=_t();l.__click=[dt,q],b(u,l)};B(E,u=>{a(n)&&u(j)})}c(_);var w=k(_,2);Y(w,21,()=>a(e),Z,(u,l)=>{var D=lt(),A=f(D);{var p=I=>{var P=vt();P.__click=[nt,q,l],b(I,P)};B(A,I=>{a(n)&&I(p)})}var h=k(A,2),N=f(h,!0);c(h);var L=k(h,2),O=f(L,!0);c(L),c(D),V(()=>{z(N,a(l).content),z(O,new Date(a(l).updated))}),b(u,D)}),c(w),b(t,d)},M=t=>{var d=ft(),_=U(d),E=f(_);E.__click=[ot,i],c(_);var j=k(_,2),w=f(j);X(w);var u=k(w,2),l=f(u);l.__click=[it,v,r,i,e];var D=k(l,2);{var A=p=>{var h=ut();h.__click=[rt,r,e,i],b(p,h)};B(D,p=>{a(r)&&p(A)})}c(u),c(j),$(w,()=>a(v),p=>s(v,p)),b(t,d)};B(J,t=>{a(i)?t(M,!1):t(K)})}c(x),b(g,x),T()}W(["click"]);export{kt as component};
